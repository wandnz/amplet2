amplet2 (0.12.0-1) unstable; urgency=low

  * throughput: change argument --sequence to --schedule to match docs.
  * package: no longer build python2 packages.
  * package: add Debian Bookworm and Ubuntu Jammy to the list of build targets.
  * package: remove Xenial, Bionic, Stretch from the list of build targets.
  * package: fix various dependencies.
  * youtube: change argument --youtube to --video-id.

 -- Brendon Jones <brendon.jones@gmail.com>  Mon, 11 Mar 2024 21:52:23 +1300

amplet2 (0.11.8-1~btm9) unstable; urgency=low

  * amplet2: fix missing destinations when merging scheduled tests.
  * http: allow passing target URL as a normal test target.
  * youtube: allow passing target video ID as a normal test target.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Fri, 29 Jul 2022 17:00:10 +1200

amplet2 (0.11.8-1~btm8) unstable; urgency=low

  * amplet2: allow configuring collector and pki server addresses separately.
  * amplet2: free parent event base before starting a remote controlled test.
  * youtube: add port to the host header if it's non standard for the scheme.
  * youtube: add basic support for firefox instead of chromium to play videos.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Fri,  8 Jul 2022 12:08:20 +1200

amplet2 (0.11.8-1~btm7) unstable; urgency=low

  * udpstream: speculative fix for using incorrect port when behind NAT.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Mon, 27 Jun 2022 16:52:54 +1200

amplet2 (0.11.8-1~btm6) unstable; urgency=low

  * amplet2: add option to set the user the client should run as.
  * amplet2: create run dir in amplet2-client rather than in the init script.
  * amplet2: display the full SHA256 hash of a certificate signing request.
  * amplet2: restrict target DNS queries based on long command line options too.
  * amplet2: allow test arguments to be given as yaml lists.
  * amplet2: don't try to change user if already running as that user.
  * amplet2: add command line option to set rundir.
  * amplet2: add missing long option for pidfile.
  * amplet2: be smarter about logging to stdout to work with pipes/redirection.
  * amplet2: don't free global variables until after they are finished with.
  * amplet2: add pid to log messages that don't use syslog.
  * amplet2: ensure errno gets reported correctly when binding sockets.
  * amplet2: use size of schedule on disk rather than content-length header.
  * amplet2: better prevent long target names in schedule breaking the resolver.
  * http: update default test connections to levels of a modern browser.
  * http: parse the whole html page only after it has finished fetching.
  * http: update the html parser to try to deal with data urls.
  * http: don't keep consuming '<' characters without checking they end the tag.
  * package: put example client config in examples dir rather than config dir.
  * package: fix checks for existing rabbitmq config before installing sample.
  * package: add flex-generated files to the list of built sources.
  * throughput: randomise the first write buffer before starting timing.
  * throughput: expose test rtt and retransmit information via ampsave.
  * updstream: use right address family and sockaddr length to reflect packets.
  * udpstream: unset SO_REUSEADDR on the test data socket.
  * youtube: update dependencies.
  * youtube: tidy up browser reconnect logic.
  * youtube: pass pre-formed json as command parameters
  * youtube: close the tab once the test is finished.
  * youtube: make sure force_exit flag is initialised.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Mon, 27 Jun 2022 11:29:19 +1200

amplet2 (0.11.7-1) unstable; urgency=low

  * amplet2: make tcpinfo functions available for all tests to use.
  * ndt: add new NDT test client code (temporarily disabled).
  * package: ensure DEB_BUILD_PROFILES reaches dpkg-buildpackage.
  * package: add Debian Bullseye to the list of build targets.
  * youtube: set protocol name so test can build with new libwebsockets.
  * youtube: add another possible chrome binary location.
  * youtube: fixed compiler warnings, removed dead code.
  * youtube: updated package dependencies.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Wed,  1 Jun 2022 11:01:28 +1200

amplet2 (0.11.6-1) unstable; urgency=low

  * amplet2: remove some unnecessary global variables.
  * amplet2: fix linker errors from global variables in headers without extern.
  * package: use parallel builds for Debian packages when possible.
  * package: update package build dependencies for Debian Bullseye.
  * package: update capabilities test to match new getcap output format.
  * package: update lintian test to work with new lintian exit codes.
  * package: no longer build packages for Debian Jessie
  * throughput: use protobuf enums directly rather than duplicating within test.
  * udpstream: use protobuf enums directly rather than duplicating within test.
  * youtube: drive a chromium browser instance rather than being one.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Thu, 17 Mar 2022 14:55:39 +1300

amplet2 (0.11.5-1) unstable; urgency=low

  * amplet2: add option to wait for ntp time sync before starting.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Thu, 25 Nov 2021 15:41:03 +1300

amplet2 (0.11.4-1) unstable; urgency=low

  * amplet2: run clients in a network namespace if the name matches.
  * throughput: restore integer division when calculating runtime in ampsave.
  * youtube: allow building test for arm64 and armhf.
  * youtube: stop the youtube test if video hasn't started after 20 seconds.
  * youtube: limit number of times youtube test will try to load iframe API.
  * youtube: only fetch test results on the first alert.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Fri, 20 Aug 2021 11:55:52 +1200

amplet2 (0.11.3-1) unstable; urgency=low

  * amplet2: add missing dependency on procps.
  * server: remove unnecessary dependency on python-protobuf.
  * server: depend on python3-ampsave rather than python-ampsave.
  * server: add simpler interface to get data in ampsave.
  * standalone tests: add missing long options --ipv4 and --ipv6.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Thu, 11 Mar 2021 21:32:32 +1300

amplet2 (0.11.2-1) unstable; urgency=low

  * amplet2: Always load /etc/hosts as part of initialising the resolver.
  * sip: Use destination hostname if set rather than extracting from SIP URI.
  * sip: Check SIP options is not null before freeing at end of test.
  * sip: Add missing package dependency for Ubuntu Bionic.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Tue,  8 Dec 2020 18:11:46 +1300

amplet2 (0.11.1-1) unstable; urgency=low

  * amplet2: Fix checking getifaddrs() to correctly recognise success.
  * server: Build python2 and python3 versions of ampsave packages.
  * sip: Only build sip packages if dependency libpjproject-dev is available.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Thu, 26 Nov 2020 14:10:37 +1300

amplet2 (0.11.0-1) unstable; urgency=low

  * all tests: keep destinations that don't resolve (#4).
  * amplet2: add trailing ':' when setting interface using ub_ctx_set_option.
  * amplet2: use libunbound to manage the nametable (#45).
  * amplet2: count empty files as missing, so certificates will be fetched.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Thu, 19 Nov 2020 13:58:58 +1300

amplet2 (0.10.6-1) unstable; urgency=low

  * amplet2: Replace function that waits for DNS responses with ub_wait().
  * amplet2: Replace 32bit IPv6 accessors with 16bit when comparing addresses.
  * amplet2: Remove unbound DNS context from global variable structure.
  * http: Don't call libcurl functions from within libcurl callbacks.
  * http: Pass a string to the lexer rather than piping data to yyin.
  * standalone tests: Call register function directly rather than using dlsym.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Fri, 11 Sep 2020 15:50:26 +1200

amplet2 (0.10.5-1) unstable; urgency=low

  * amplet2: Zero control struct before use, preventing a crash on exit.
  * amplet2: Check socket options exist before trying to compile them.
  * amplet2: Replace index() and rindex() with strchr() and strrchr().
  * package: Conflict with old amplet2-chromium-libs packages.
  * package: Suggest amplet2-client-sip and amplet2-client-youtube packages.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Wed, 26 Aug 2020 11:16:16 +1200

amplet2 (0.10.4-1) unstable; urgency=low

  * sip: Allow test to take both a URI and a normal target.
  * sip: Update man page with new options.
  * sip: Remove (unused) "family" from result dict, to match other tests.
  * traceroute: Don't increment TTL if already at the maximum path length.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Fri,  3 Jul 2020 15:23:25 +1200

amplet2 (0.10.3-1) unstable; urgency=low

  * amplet2: Allow setting default parameters for servers started by tests.
  * amplet2: Allow including other files in the client configuration file.
  * sip: Fix copy and paste error in mutex name.
  * sip: Start remote server before initialising pjsip locally.
  * sip: Cleanup and return more often rather than exiting with error.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Thu, 28 May 2020 10:40:43 +1200

amplet2 (0.10.2-1) unstable; urgency=low

  * amplet2: Switch to using libevent rather than libwandevent (#41).
  * amplet2: Set server name indication on rabbitmq shovels.
  * fastping: Free percentile data in summary structures when finished.
  * package: Set VCS fields in Debian control file.
  * sip: Set minimum targets for test to zero (it could be a URI instead).
  * sip: Correctly flag options as not having arguments.
  * sip: Set DSCP bits, and send the option to the server too.
  * sip: Add optional account registration.
  * sip: Remove all codecs except PCMA/8000 and set clock rate to 8000Hz.
  * sip: Fix incorrect loss percent/period used by SIP test to calculate MOS.
  * sip: Fix use of original transport config instead of the duplicated one.
  * sip: Ensure new 8000Hz wav file is part of the amplet2-client-sip package.
  * standalone tests: Avoid shadowing test specific long options struct.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Fri, 22 May 2020 16:50:36 +1200

amplet2 (0.10.1-1) unstable; urgency=low

  * package: remove unnecessary /usr/sbin directory from debian install dirs.
  * package: add extra dependency for amplet2-client-sip on Ubuntu Bionic.
  * package: add extra build dependencies for amplet2-client-youtube package.
  * youtube: build a separate deb package containing the youtube test.
  * youtube: don't print test timing results if they aren't set.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Mon, 30 Mar 2020 15:10:43 +1300

amplet2 (0.10.0-1) unstable; urgency=low

  * amplet2: move standalone test binaries from /usr/sbin to /usr/bin/.
  * sip: fix building the test with older libpjsip packages.
  * sip: fix building the test on armhf and arm64 architectures.
  * sip: build a separate {deb,rpm} package containing the sip test.
  * udpstream: link the test with -lm again.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Tue, 24 Mar 2020 09:47:14 +1300

amplet2 (0.9.14-1) unstable; urgency=low

  * package: no longer build transitional package amplet2-client-lite.
  * package: add Debian/Ubuntu arm64 to the list of GitLab CI/CD build targets.
  * sip: add new SIP/RTP test, currently disabled by default.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Tue, 10 Mar 2020 10:44:14 +1300

amplet2 (0.9.13-1) unstable; urgency=low

  * dns: use SO_TIMESTAMPING to get timestamps for sent packets (#35).
  * fastping: use SO_TIMESTAMPING to get timestamps for sent packets (#35).
  * icmp: use SO_TIMESTAMPING to get timestamps for sent packets (#35).
  * tcpping: use SO_TIMESTAMPING to get timestamps for sent packets (#35).
  * traceroute: use SO_TIMESTAMPING to get timestamps for sent packets (#35).
  * udpstream: fix incorrect test name in error message.
  * amplet2: make shovel prefetch-count configurable, set to 1 by default (#38).

 -- Brendon Jones <brendonj@waikato.ac.nz>  Mon, 24 Feb 2020 16:54:56 +1300

amplet2 (0.9.12-1) unstable; urgency=low

  * amplet2: add workaround for setsockopt failure under non-amd64 qemu/docker.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Thu, 14 Nov 2019 13:19:55 +1300

amplet2 (0.9.11-1) unstable; urgency=low

  * dns: avoid waiting for LOSS_TIMEOUT if no packets are outstanding.
  * dns: only count DNS query length if the query was actually sent.
  * fastping: be stricter in checking before reporting parts of results.
  * fastping: ignore duplicate responses.
  * fastping: limit valid fastping sequence numbers to those sent.
  * fastping: check length of data when validating fastping response.
  * fastping: add more debugging output.
  * fastping: apply a BPF filter to restrict incoming response packets.
  * fastping: sleep less at low sending rates.
  * http: ensure server/object/global start/end times always get set.
  * http: total object count should also include failed objects.
  * icmp: avoid waiting for LOSS_TIMEOUT if no packets are outstanding.
  * tcpping: avoid waiting for LOSS_TIMEOUT if no packets are outstanding.
  * throughput: avoid using default protobuf values for runtime and bytes.
  * traceroute: fix reporting too many non-responsive hops.
  * traceroute: don't connect to whois server with no addresses to query.
  * udpstream: be stricter in checking before reporting parts of results.
  * all tests: update to accept unresolved hostnames as destinations.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Wed, 23 Oct 2019 16:46:37 +1300

amplet2 (0.9.10-1) unstable; urgency=low

  * dns: fix incorrect test name in error message.
  * amplet2: explicitly set protocol buffer version 2 in .proto files.
  * amplet2: replace deprecated ASN1_STRING_data() with ASN1_STRING_get0_data().
  * amplet2: replace deprecated RSA_generate_key() with RSA_generate_key_ex().

 -- Brendon Jones <brendonj@waikato.ac.nz>  Mon, 19 Aug 2019 16:10:24 +1200

amplet2 (0.9.9-1) unstable; urgency=low

  * package: version the init-system-helpers dependency to appease lintian.
  * amplet2: set CAP_NET_ADMIN to run tcpping test.
  * amplet2: set CAP_NET_BIND_SERVICE to run throughput and udpstream tests.
  * tcpping: set CAP_NET_ADMIN to allow pcap capture.
  * throughput: set CAP_NET_BIND_SERVICE to allow binding to low ports.
  * udpstream: set CAP_NET_BIND_SERVICE to allow binding to low ports.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Thu, 11 Jul 2019 17:07:19 +1200

amplet2 (0.9.8-1) unstable; urgency=low

  * package: create directories during postinst rather than in init scripts.
  * amplet2: start as root to run rabbitmqctl before switching to amplet user.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Fri,  5 Jul 2019 16:43:18 +1200

amplet2 (0.9.7-1) unstable; urgency=low

  * amplet2: run all test processes as a non-privileged user.
  * amplet2: update man pages with capabilities and links to other programs.
  * udpstream: fix incorrect test name in error message.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Wed,  3 Jul 2019 13:42:19 +1200

amplet2 (0.9.6-1) unstable; urgency=low

  * external: drop all groups before setting user/group to "nobody" (#33).
  * external: add missing man page to package.
  * fastping: add missing man page to package.
  * fastping: link libm correctly with the test library.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Thu, 13 Jun 2019 17:21:15 +1200

amplet2 (0.9.5-1) unstable; urgency=low

  * external: enable test by default (#33).

 -- Brendon Jones <brendonj@waikato.ac.nz>  Tue, 11 Jun 2019 17:18:35 +1200

amplet2 (0.9.4-1) unstable; urgency=low

  * amplet2: add new test to run external programs (temporarily disabled) (#33).
  * package: remove Debian Wheezy build scripts and sysvinit/upstart (#31).
  * fastping: fix incorrect test name on man page.
  * youtube: use strictly incrementing javascript timer.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Thu,  9 May 2019 11:55:59 +1200

amplet2 (0.9.3-1) unstable; urgency=low

  * fastping: enable test by default (#26).
  * fastping: add missing header to the distribution tarball.
  * fastping: change result fields to better match backend expectations.
  * fastping: change offset into fastping packet depending on address family.
  * fastping: sleep at low packet rates when possible.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Thu, 11 Apr 2019 14:51:27 +1200

amplet2 (0.9.2-1) unstable; urgency=low

  * youtube: set chromium UserDataDir to /tmp/.amplet2/chromium/ (#29).
  * youtube: move wrapper from /usr/sbin/ to avoid creating dirs there (#29).
  * youtube: terminate cleanly if player receives an error (#30).

 -- Brendon Jones <brendonj@waikato.ac.nz>  Thu, 28 Mar 2019 16:31:56 +1300

amplet2 (0.9.1-1) unstable; urgency=low

  * amplet2: close the pidfile after writing the PID.
  * dns: change nsid result field name so it doesn't shadow header variable.
  * package: change amplet2-server package architecture from "any" to "all".
  * package: use GitLab CI/CD to upload built packages to bintray.
  * youtube: always set and report the YouTube test user agent.
  * youtube: add flag to specify maximum run time of a YouTube video.
  * youtube: print console.log() messages in the YouTube test to the debug log.
  * youtube: fix horizontal resolution for "large" quality.
  * youtube: rework Makefile to build more sensibly.
  * youtube: mute video by default so it will autoplay.
  * youtube: update to use Chromium version 71.0.3578.98.
  * youtube: add /usr/lib/chromium-brower to RPATH for libffmpeg.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Fri, 15 Feb 2019 16:19:12 +1300

amplet2 (0.9.0-1) unstable; urgency=low

  * build: libamp.so is now versioned (#15).
  * amplet2: remove bounds checking for test IDs so all values are valid. This
    allows others to write tests without needing to recompile amplet2 (#15).
  * amplet2: Fix argument parsing by scheduler to deal with quotes (#19).
  * dns: update unit tests for new rrsig and nsid fields (#23, #24).
  * amplet2: add new high frequency ICMP stream test "fastping" (#26).
  * amplet2: set environ to NULL after free, so cleanup functions don't use it.
  * amplet2: Print line number of config block when reporting schedule errors.
  * package: update to debhelper compat level 9.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Fri,  2 Nov 2018 15:41:15 +1300

amplet2 (0.8.4-1) unstable; urgency=low

  * package: don't try to install sample rabbitmq.config if file doesn't exist.
  * amplet2: fix crash caused by incorrect/duplicated SSL cleanup.
  * amplet2: fix small memory leak when unregistering test modules.
  * amplet2: fix exit codes to be more consistent (#2).
  * dns: report on presence of RRSIG resource records if DNSSEC enabled (#23).
  * dns: fix result handing to correctly extract NSID responses (#24).

 -- Brendon Jones <brendonj@waikato.ac.nz>  Mon,  3 Sep 2018 15:25:36 +1200

amplet2 (0.8.3-1) unstable; urgency=low

  * http: allow setting a proxy to use.
  * http: allow setting the User-Agent string to use.
  * http: correctly null terminate headers without clobbering the next one.
  * server: fix postinst setup to work with rabbitmq-server >= 3.7.0.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Mon, 30 Jul 2018 15:33:08 +1200

amplet2 (0.8.2-1) unstable; urgency=low

  * amplet2: Set shovel reconnect delay to random value between 60s and 180s.
  * amplet2: Add new YouTube video streaming quality test.
  * standalone tests: Don't wait for name resolution if there are no names.
  * build: Try to be more accurate regarding which headers are included.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Mon, 23 Jul 2018 13:51:46 +1200

amplet2 (0.8.1-1) unstable; urgency=low

  * amplet2: allow tests to be limited to a single address family.
  * throughput: replace web10g with newly available TCP_INFO stats.
  * throughput: report total data transmitted using power of two units.
  * udpstream: increase wait time for reflected packets once sending complete.
  * package: supply sample rabbitmq.config files, installing the client config
    file if one doesn't already exist.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Tue,  7 Nov 2017 16:36:55 +1300

amplet2 (0.8.0-1) unstable; urgency=low

  * build: add missing dependency on flex.
  * build: update SSL library check to still succeed with newer versions.
  * build: check for external SASL method in AMQP library.
  * throughput: fix EADDRINUSE by not binding to addresses that aren't used.
  * http: extract count of failed object fetches in ampsave.
  * server: force tcpreused to always be false in throughput test results.
  * amplet2: move SSL configuration to its own section in the config file.
  * amplet2: set default value of vialocal based on rabbitmq being present.
  * amplet2: set default collector SSL config option based on the port used.
  * amplet2: use server-side cipher list ordering.
  * amplet2: ensure that the correct versions of librabbitmq functions are
    used that match the version listed as a dependency.
  * amplet2: don't allow negative latency values, clamp them at zero.
  * amplet2: improve some error messages to be more useful/accurate.
  * amplet2: set --no-as-needed to build test libraries using newer GCC.
  * amplet2: don't crash when bad options are given on the command line.
  * package: update init script to configure rabbitmq and required directories.
  * package: try to avoid restarting services unnecessarily on package install.
  * package: rename rsyslogd config file so it sorts earlier than default.
  * package: removed amplet2-client-lite packages, determine rabbitmq usage at
    runtime.
  * throughput: added ability to masquerade as HTTP POST stream.
  * throughput: removed test control headers from data stream.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Fri, 21 Jul 2017 16:16:23 +1200

amplet2 (0.7.1-1) unstable; urgency=low

  * http: try to parse URL fragments or decimal encoded characters.
  * http: split URLs where '?' is used after hostname without '/'.
  * traceroute: use library functions to receive packets rather than calling
    the low level functions directly.
  * testlib: fix wrapping values when comparing timevals on 32-bit machines.
  * amplet2: remove default collector address and make it mandatory to be set.
  * Update documentation.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Wed,  5 Oct 2016 16:01:16 +1300

amplet2 (0.7.0-1) unstable; urgency=low

  * Add access control list for access to starting test servers, running tests.
  * Remove standard Diffie-Hellman ciphers from list of allowable choices.
  * Use libwandevent to run packet probing in icmp and dns tests.
  * Use backported librabbitmq4 rather than our own version with EXTERNAL auth.
  * Fix scheduling bug where the wrong time units could be used in some cases.
  * Don't start the tcpping test loss timer till after the last packet is sent.
  * Always include the scheme when reporting an HTTP test URL.
  * Improve logging around fetching ASN data for traceroute test.
  * Remove unused stopset code from traceroute test.
  * Improve accuracy of probe timers in traceroute test.
  * Randomise first TTL in traceroute test to help spread probes out.
  * Add command line options to configure the traceroute probing window.
  * Bind remotely started test servers to the correct interface and address.
  * Fix certificate request retry timer to properly cap at the maximum value.
  * Don't enforce client-wide minimum packet spacing in the udpstream test.
  * Deal better with setting inter packet gap if time goes backwards.
  * Tighten schedule clock fudge factor from 500ms to 100ms.
  * Use '!' instead of ':' to specify address families in the schedule file.
  * Tidy Debian init scripts to remove unused portions.
  * Add manpages for amplet2-remote and amp-udpstream.
  * Update example configuration file documentation.
  * Update usage statements for binaries.
  * Update build dependencies.
  * Update licensing.
  * Update man pages.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Mon, 26 Sep 2016 11:13:30 +1300

amplet2 (0.6.2-1) unstable; urgency=low

  * Added new test to perform udp jitter/latency/loss/mos tests.
  * Fix bug in tcpping test where SYN payload could prevent matching packets.
  * Fix bug where non-default control port wasn't being passed to tests.
  * DSCP bits are now reported for all tests.
  * Print short error messages on init script failure.
  * Minor updates to man pages.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Tue, 31 May 2016 15:22:01 +1200

amplet2 (0.6.1-1) unstable; urgency=low

  * Follow redirects when fetching remote schedule files.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Mon, 18 Apr 2016 16:51:01 +1200

amplet2 (0.6.0-3) unstable; urgency=low

  * Call /bin/kill rather than using the shell builtin in init script.
  * Prevent process group member PIDs from being printed by the init script.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Mon, 18 Apr 2016 14:04:37 +1200

amplet2 (0.6.0-2) unstable; urgency=low

  * Try not to confuse kill command with negative pids that look like flags.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Mon, 18 Apr 2016 11:41:59 +1200

amplet2 (0.6.0-1) unstable; urgency=low

  * Add ability to set DSCP bits for all tests.
  * Reuse SSL control connection when being asked by a remote client to start
    a test server rather than creating a new redundant one.
  * Use the same code path for control traffic whether using SSL or not.
  * Watchdog timers are now run inside the child process.
  * Add ability to remotely trigger test execution.
  * Force refetch of remote schedule on a SIGUSR2.
  * Unblock signals on child processes so they can be killed by init scripts.
  * Fix bug in tcpping test where packet size was incorrectly calculated.
  * Fix bug in dns test where payload size EDNS option wasn't being set.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Thu, 14 Apr 2016 16:40:13 +1200

amplet2 (0.5.6-2jessie1) unstable; urgency=low

  * Do some of dh_installinit manually so that it works properly on jessie.
  * Install a systemd service file.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Thu,  3 Mar 2016 16:19:10 +1300

amplet2 (0.5.6-1) unstable; urgency=low

  * Try to deal with URLs at the top level starting with "../" in the HTTP test.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Thu, 25 Feb 2016 15:34:46 +1300

amplet2 (0.5.5-3) unstable; urgency=low

  * Don't recursively modify key permissions on install.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Wed,  6 Jan 2016 14:52:23 +1300

amplet2 (0.5.5-2) unstable; urgency=low

  * Set the keys directory to be owned by root:rabbitmq on install.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Wed,  6 Jan 2016 13:45:05 +1300

amplet2 (0.5.5-1) unstable; urgency=low

  * Deal with Linux SLL frames as well as Ethernet frames in TCP ping test.
  * Free BPF filters after they have been installed in TCP ping test.
  * Fix permissions again for downloaded certificates.
  * Exponentially backoff when checking for newly signed certificates.
  * Update return values in init script to hopefully better work with systemd.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Tue,  5 Jan 2016 11:24:01 +1300

amplet2 (0.5.4-1) unstable; urgency=low

  * Fix crash when checking the address families on interfaces with no address.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Mon,  7 Dec 2015 10:45:12 +1300

amplet2 (0.5.3-1) unstable; urgency=low

  * Smarter default configuration for ampname.
  * Fixed permissions for downloaded certificates.
  * Quieten some unnecessary log messages.
  * Write pidfile earlier to help prevent puppet starting multiple instances.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Tue,  1 Dec 2015 10:34:51 +1300

amplet2 (0.5.2-1) unstable; urgency=low

  * Init script should wait for each client to start before continuing.
  * Dynamically link standalone tests to the specific test libraries.
  * Prevent possible race in TCP ping test.
  * Update TCP ping and HTTP test to work in Debian Jessie.
  * Exit main event loop on SIGTERM so we can log shutdown messages.
  * Updated documentation.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Tue, 27 Oct 2015 14:12:47 +1300

amplet2 (0.5.0-1) unstable; urgency=low

  * Use Google protocol buffers when reporting test results.
  * Allow tests to accept zero targets if they have default behaviour.
  * Lower traceroute timeout from 3s to 2s to speed up tests.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Mon, 31 Aug 2015 14:53:23 +1200

amplet2 (0.4.8-1) unstable; urgency=low

  * Rewrite ASN lookups to deal better with whois server issues.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Fri, 17 Jul 2015 14:17:01 +1200

amplet2 (0.4.7-3) unstable; urgency=low

  * More debug around ASN lookups during traceroute test.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Tue, 14 Jul 2015 15:01:54 +1200

amplet2 (0.4.7-2) unstable; urgency=low

  * More debug around ASN lookups during traceroute test.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Thu,  9 Jul 2015 17:04:57 +1200

amplet2 (0.4.7-1) unstable; urgency=low

  * Break report messages into blocks of 255 results.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Thu,  9 Jul 2015 14:23:49 +1200

amplet2 (0.4.6-1) unstable; urgency=low

  * Don't update HTTP endtime after cleaning up - let returned objects set it.
  * Don't try to log an ampname before it has been set.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Tue, 12 May 2015 11:34:46 +1200

amplet2 (0.4.5-1) unstable; urgency=low

  * Don't count failed object fetches towards global HTTP test statistics.
  * First basic attempt to include the ampname when logging to syslog.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Mon, 11 May 2015 16:09:20 +1200

amplet2 (0.4.4-1) unstable; urgency=low

  * Add runtime option to HTTP test to force SSL version.
  * Add config option to amplet2 client to set minimum inter-packet delay.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Fri,  8 May 2015 13:37:11 +1200

amplet2 (0.4.3-1) unstable; urgency=low

  * Don't report HTTP test data if name resolution fails (same as other tests).
  * Add HTTP test option to suppress parsing of initial object.
  * Fix comparison of test schedule objects to properly check end time.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Fri, 27 Mar 2015 11:11:11 +1300

amplet2 (0.4.2-1) unstable; urgency=low

  * Don't do address to name translation when accepting on control socket.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Fri, 18 Mar 2015 14:40:26 +1300

amplet2 (0.4.1-1) unstable; urgency=low

  * Always initialise SSL, even if not needed for reporting to rabbitmq.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Fri, 13 Mar 2015 11:13:25 +1300

amplet2 (0.4.0-1) unstable; urgency=low

  * Add ability to generate keys and fetch signed certificates if not present.
  * Fix HTTP test to deal with HTTPS URLs.
  * Speed up random packet generation in throughput test by using /dev/urandom.
  * Always configure rabbitmq if with a local broker (unless configured not to).
  * Fix the nametable to properly use names as targets.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Tue, 10 Mar 2015 17:31:28 +1300

amplet2 (0.3.9-1) unstable; urgency=low

  * Fix rescheduling tests when slightly early around test period boundaries.
  * Fix a possible infinite loop in the tcpping test.
  * Replace an assert with a warning when a watchdog can't be removed.
  * Add ability to dump schedule config when receiving a SIGUSR2.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Wed, 11 Feb 2015 14:44:54 +1300

amplet2 (0.3.8-1) unstable; urgency=low

  * Fix tcpping test when bound to a single interface.
  * Quieten some too common, unhelpful warning messages.
  * Fix tests being rescheduled immediately due to clock drift.
  * No longer attempts to resolve address families the test interface lacks.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Wed,  3 Dec 2014 17:29:28 +1300

amplet2 (0.3.7-1) unstable; urgency=low

  * Bring the schedule parser in line with the generated schedules.
  * Fix buffer management when fetching large amounts of ASN data.
  * Fix HTTP test to record and follow 3XX redirects.
  * Fix HTTP test to better deal with headers using weird separators/caps.
  * Fix traceroute test when low TTL responses incorrectly decrement TTL.
  * Allow tests to be warned before the watchdog attempts to kill them.
  * Properly close local unix sockets (ASN, DNS) when forking for a test.
  * Enabled Debian compile-time options to harden binaries.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Mon,  3 Nov 2014 16:40:42 +1300

amplet2 (0.3.6-1) unstable; urgency=low

  * Updated schedule file format to new testing YAML format.
  * Updated ASN fetching for traceroute test to use TCP bulk whois interface.
  * Fix HTTP test crashing with long URLs.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Tue, 30 Sep 2014 16:12:40 +1300

amplet2 (0.3.5-1) unstable; urgency=low

  * Use package name as ident when logging to syslog.
  * Update test thread names to reflect the test being performed.
  * Use socket timestamps rather than gettimeofday() where possible.
  * Upgrade from libwandevent2 to libwandevent3.
  * Use local stopsets in traceroute test to reduce nearby probing.
  * Add option to traceroute test to fetch AS numbers for addresses in path.
  * Added TCPPing test.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Thu, 28 Aug 2014 14:06:14 +1200

amplet2 (0.3.3-2) unstable; urgency=low

  * Use local resolvers from /etc/resolv.conf if none specified.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Wed, 18 Jun 2014 15:21:28 +1200

amplet2 (0.3.2-1) unstable; urgency=low

  * Fix name resolution threads writing to dead test processes.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Wed, 11 Jun 2014 16:26:59 +1200

amplet2 (0.3.1-1) unstable; urgency=low

  * New release for all currently deployed amplets.
  * Fix name resolution to properly return address family.
  * Fix race condition when counting outstanding DNS queries.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Fri,  6 Jun 2014 13:48:11 +1200

amplet2 (0.3.0-1) unstable; urgency=low

  * Tidy some build scripts (automake and python setuptools).

 -- Brendon Jones <brendonj@waikato.ac.nz>  Wed,  4 Jun 2014 17:44:26 +1200

amplet2 (0.2.6-2) unstable; urgency=low

  * Init script should stop all instances with a pidfile, rather than only
    those that have a config file.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Fri,  30 May 2014 17:22:33 +1200

amplet2 (0.2.6-1) unstable; urgency=low

  * Minor bugfixes.
  * Removed test timing code in ICMP test that was being included in packages.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Thu,  29 May 2014 16:55:20 +1200

amplet2 (0.2.5-2) unstable; urgency=low

  * Require libunbound2 rather than libunbound.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Wed,  28 May 2014 13:38:17 +1200

amplet2 (0.2.5-1) unstable; urgency=low

  * New upstream release.
  * Name resolution now uses libunbound and happens in separate threads.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Thu,  22 May 2014 17:21:21 +1200

amplet2 (0.2.4-1) unstable; urgency=low

  * New upstream release.
  * Set custom nameservers per test process rather than on the parent.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Wed,  14 May 2014 17:20:28 +1200

amplet2 (0.2.3-1) unstable; urgency=low

  * New upstream release.
  * Fix test parameters where parameters included a delimiting comma.
  * Allow multiple client configuration in configuration directory.
  * Use vhosts with rabbitmq to isolate our data.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Fri,  9 May 2014 17:49:23 +1200

amplet2 (0.2.2-1) unstable; urgency=low

  * New upstream release.
  * Now links binaries with fewer unnecessary libraries.
  * Allows custom nameservers to be specified at runtime.
  * Control socket will default to global interface configuration if no
    specific configuration is given.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Tue, 29 Apr 2014 14:10:04 +1200

amplet2 (0.2.1-1) unstable; urgency=low

  * New upstream release.
  * Added ability to set source address/interface to HTTP/throughput tests.
  * Reported data for throughput test now includes target name.
  * Throughput test will now try to find a free port to use rather than fail.
  * Control socket can now be set to listen on a specific address/interface.
  * Test saving functions now properly null undefined fields.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Mon, 31 Mar 2014 15:51:54 +1300

amplet2 (0.2.0-1) unstable; urgency=low

  * New upstream release.
  * Removed fixed size buffers from most test report messages.
  * Try to better avoid parsing javascript in the HTTP test.
  * Fix nametable to work with more than one name.
  * Added fetching schedules via HTTP/HTTPS.
  * Added a control socket to start local test servers via HTTPS.
  * Added ability to set source address/interface to ICMP/traceroute/DNS tests.
  * Added throughput test.
  * Added basic unit tests for some behaviour.
  * More documentation.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Tue, 18 Mar 2014 15:57:03 +1300

amplet2 (0.1.13-1) unstable; urgency=low

  * New upstream release.
  * Fix possibly uninitialised values being reported by DNS test.
  * Fix segfault when exiting traceroute test.
  * Increase watchdog timeouts for killing tests.
  * Log basic information about any test that gets killed for running too long.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Thu, 16 Jan 2014 14:22:20 +1300

amplet2 (0.1.12-1) unstable; urgency=low

  * New upstream release.
  * Resolve all target names in the schedule file by default.
  * Deal more gracefully in tests with packets that can't be sent.
  * Allow the same name to be defined multiple times in the nametable.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Wed, 18 Dec 2013 13:42:08 +1300

amplet2 (0.1.11-1) unstable; urgency=low

  * New upstream release.
  * Properly terminate libconfuse option structures.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Thu, 12 Dec 2013 11:16:21 +1300

amplet2 (0.1.10-10) unstable; urgency=low

  * Use the correct argument to chown to get recursion.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Thu, 12 Dec 2013 09:36:50 +1300

amplet2 (0.1.10-9) unstable; urgency=low

  * Give the rabbitmq user access to the keys it needs to run the shovel.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Mon,  9 Dec 2013 14:35:32 +1300

amplet2 (0.1.10-8) unstable; urgency=low

  * Enable the http test.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Fri,  6 Dec 2013 15:41:22 +1300

amplet2 (0.1.10-7) unstable; urgency=low

  * Revert the specific amplet user changes, easier to run as root for now.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Fri,  6 Dec 2013 15:32:24 +1300

amplet2 (0.1.10-6) unstable; urgency=low

  * Don't do anything with rabbit during postinst if $HOME is not set.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Fri,  6 Dec 2013 14:18:20 +1300

amplet2 (0.1.10-5) unstable; urgency=low

  * Don't create home directory for amplet user.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Fri,  6 Dec 2013 13:26:58 +1300

amplet2 (0.1.10-4) unstable; urgency=low

  * Create the "amplet" user to run everything.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Fri,  6 Dec 2013 11:08:57 +1300

amplet2 (0.1.10-3) unstable; urgency=low

  * Fix empty if block in postinst.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Fri,  6 Dec 2013 10:34:27 +1300

amplet2 (0.1.10-2) unstable; urgency=low

  * Make sure init/default scripts are named appropriately in lite package.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Mon,  4 Dec 2013 12:03:19 +1300

amplet2 (0.1.10-1) unstable; urgency=low

  * Still struggling to find consistency with file names.
  * Don't install both versions of the config file, limit it based on package.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Mon,  4 Dec 2013 11:15:37 +1300

amplet2 (0.1.9-1) unstable; urgency=low

  * Fix http test to use the correct start timestamp
  * Make paths and filenames more consistent ("amplet2")

 -- Brendon Jones <brendonj@waikato.ac.nz>  Mon,  2 Dec 2013 13:53:06 +1300

amplet2 (0.1.8-3) unstable; urgency=low

  * Remove pointless init scripts and default files from amplet2-server, for
    now it only needs to be the python test parsing.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Fri, 18 Oct 2013 11:44:55 +1300

amplet2 (0.1.8-2) unstable; urgency=low

  * Depend on custom librabbitmq library instead of normal one

 -- Brendon Jones <brendonj@waikato.ac.nz>  Wed, 16 Oct 2013 12:03:35 +1300

amplet2 (0.1.8-1) unstable; urgency=low

  * Quieten some log messages in tests.
  * Deal properly with SIGHUP when not run as a daemon.
  * Basic support for fetching remote configs over HTTP.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Tue, 15 Oct 2013 13:28:08 +1300

amplet2 (0.1.7-2) unstable; urgency=low

  * Create keys directory and set permissions appropriately.
  * Prepare to create local rabbitmq users (but don't yet).

 -- Brendon Jones <brendonj@waikato.ac.nz>  Fri, 13 Sep 2013 15:27:39 +1200

amplet2 (0.1.7-1) unstable; urgency=low

  * New upstream release.
  * Fixed incorrect packet sizes in traceroute test.
  * Fixed method of dealing with late response packets in traceroute test.
  * Schedule file can now limit name resolution to ipv4/ipv6.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Mon, 9 Sep 2013 14:29:56 +1200

amplet2 (0.1.6-1) unstable; urgency=low

  * New upstream release
  * Split into two packages, one using a local broker, one without.
  * Reworked messaging code slightly to use better userids.
  * Use hostname as the default value of ampname.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Tue, 27 Aug 2013 19:06:38 +1200

amplet2 (0.1.5-2) unstable; urgency=low

  * Include rabbitmq configuration in the package and install if possible.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Thu, 22 Aug 2013 15:40:22 +1200

amplet2 (0.1.5-1) unstable; urgency=low

  * New upstream release.
  * Fixed traceroute test to properly ignore other tests TTL exceeded messages.
  * Fixed an issue where resolving test addresses would not return all of them.
  * Added basic SSL authentication to the broker.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Mon, 19 Aug 2013 16:11:19 +1200

amplet2 (0.1.4-1) unstable; urgency=low

  * New upstream release.
  * No longer uses inotify, configuration is updated after a SIGHUP.
  * Schedule configuration is now a directory rather than a single file.
  * Log level is now configurable and able to be overridden on command line.
  * icmp test deals better with ICMP_REDIRECT.
  * dns test will only calculate a response length when it is sensible.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Fri, 29 May 2013 18:01:35 +1200

amplet2 (0.1.3-1) unstable; urgency=low

  * New upstream release.
  * Merge libamp and libmeasured into a single library, libamp.
  * Fix install locations of files into the system.
  * Be more consistent with use of package name.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Wed, 29 May 2013 14:15:03 +1200

amplet2 (0.1.2-1) unstable; urgency=low

  * New upstream release.
  * Fix http test reporting to properly order and pack data structures.
  * Add python code to extract http test data from a report

 -- Brendon Jones <brendonj@waikato.ac.nz>  Wed, 8 May 2013 14:09:58 +1200

amplet2 (0.1.1-1) unstable; urgency=low

  * New upstream release.
  * Change logging to use syslog rather than writing logs manually.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Tue, 1 May 2013 17:19:22 +1200

amplet2 (0.1-3) unstable; urgency=low

  * Fix init scripts to actually start and stop measured.
  * Don't try to start measured by default.
  * Run configure with proper file locations set for private libraries.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Tue, 1 May 2013 15:52:55 +1200

amplet2 (0.1-2) unstable; urgency=low

  * Update dependencies to use correct package names.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Tue, 30 Apr 2013 16:26:28 +1200

amplet2 (0.1-1) unstable; urgency=low

  * Initial testing release.

 -- Brendon Jones <brendonj@waikato.ac.nz>  Fri, 26 Apr 2013 15:17:17 +1200
